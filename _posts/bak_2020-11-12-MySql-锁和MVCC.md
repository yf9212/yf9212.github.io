---
title: MySql的锁和MVCC
key: mysql-lock-and-mvcc
modify_date: 2020-11-12 18:1:00
sharing: true
license: false
layout: article
tags: mysql lock mvcc
---
## MySql基础知识
MySql作为互联网公司常用的关系型数据库，数据存储落地的关键一环，了解其基础原理也是一个使用者不可或缺的，可以帮助我们更好的使用它。


### mysql常用的引擎
1. InnoDB 

InnoDB作为事务型数据库的首选引擎，支持事务安全表、主持行锁定和外键，提供事务提交、回滚、和奔溃恢复能力；支持外键完整性约束


2. MyISAM 

MyISAM提供大量的特性，包括全文索引、压缩等，但是不支持事务支持，不支持行级锁和外键，insert和update操作时要锁定整个表，效率相对来说会比较低；适用与查多写少的应用场景，例如数据湖



### 事务隔离级别
1. 读未提交(read uncommit)
2. 读已提交(read committed)
3. 可重复度(repeatable read)
4. 串行化(serializable)

|  隔离级别   | 赃读  |  不可重复读 | 幻读 | 解释 |
|  ----  | ----  | ----  | ---- | ---- |
| Read uncommit| √ | √ | √ | 事务中的修改，即使没提交，对其他事务也是可见的。事务可以读取未提交的数据，这种情况成为赃读 |
| Read committed |x |  √ | √ | 一个事务开始时，只能看见已提交的事务所做的修改，也意味着这个事务的任何修改对其他事务都是不可见的；同样也会产生一个问题，两次同样的查询，得到不一样的结果 |
| Repeatable read |x | x | √ | 在同一个事务中，多次查询得到的结果总是一样；但是同样会产生幻读，幻读是指A事务查询指定范围的记录，事务B在这个范围内插入一条新数据并提交，事务A再次查询，产生幻行 |
| Serializable |x | x | x | 强制实物串行化执行，每次读都要获取表级别的共享锁，读写相互阻塞 |

### 锁

#### 锁粒度
* 行锁
	
* 表锁




	